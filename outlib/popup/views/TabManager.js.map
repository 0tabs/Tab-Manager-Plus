{"version":3,"sources":["../../../lib/popup/views/TabManager.jsx"],"names":["browser","chrome","TabManager","props","navigator","userAgent","search","check","permissions","contains","then","result","setLocalStorage","state","hideWindows","bind","layout","animations","windowTitles","compact","dark","tabactions","badge","sessionsFeature","filterTabs","tabLimit","openInOwnTab","tabWidth","tabHeight","closeTimeout","resetTimeout","lastOpenWindow","windows","sessions","selection","lastSelect","hiddenTabs","tabsbyid","windowsbyid","height","hasScrollBar","focusUpdates","topText","bottomText","lastDirection","optionsActive","dupTabs","dragFavicon","colorsActive","addWindow","animationsText","badgeText","changelayout","changeTabHeight","changeTabLimit","changeTabWidth","checkKey","clearSelection","compactText","darkText","deleteTabs","discardTabs","donate","exportSessions","exportSessionsText","getTip","hideText","highlightDuplicates","hoverIcon","importSessions","importSessionsText","openInOwnTabText","pinTabs","rateExtension","scrollTo","sessionsText","sessionSync","tabActionsText","tabHeightText","tabLimitText","tabWidthText","toggleAnimations","toggleBadge","toggleCompact","toggleDark","toggleFilterMismatchedTabs","toggleHide","toggleOpenInOwnTab","toggleOptions","toggleSessions","toggleTabActions","toggleWindowTitles","update","windowTitlesText","storage","local","get","document","body","className","setState","tab","title","url","clearTimeout","setTimeout","e","nativeEvent","preventDefault","stopPropagation","text","target","bottom","indexOf","a","split","forceUpdate","_this","hiddenCount","tabCount","haveMin","haveSess","i","length","searchLen","Object","keys","map","window","id","tabs","incognito","hoverHandler","toggleColors","deleteTab","select","selectTo","drag","drop","dropWindow","maybePluralize","readablelayout","nextlayout","opacity","loadStorage","runUpdate","debounce","runTabUpdate","tabid","changeinfo","refs","windowId","checkSettings","onCreated","addListener","onUpdated","onMoved","onRemoved","onReplaced","onDetached","onAttached","onActivated","onFocusChanged","runtime","onMessage","request","sender","sendResponse","console","log","command","window_ids","window_id","onChanged","root","focus","focusRoot","scrollArea","getElementsByClassName","activeWindow","activeTab","scrollTop","getLocalStorage","scrollIntoView","behavior","block","inline","values","key","sess","windowsInfo","push","activeElement","val","create","active","getAll","populate","sort_windows","sort","b","aSort","bSort","j","_this2","sendMessage","query","currentWindow","t","remove","tabId","discard","_this3","count","inPopup","close","_this4","index","pinned","reverse","searchbox","value","idList","dup","id2","tab2","searchQuery","searchType","searchTerms","filter","entry","trim","lastSearchLen","tabSearchTerm","toLowerCase","match","searchOR","andMatch","searchAND","matches","matchtext","keyCode","type","windowcontainer","goLeft","goRight","goUp","goDown","altKey","metaKey","shiftKey","ctrlKey","selectedTabs","found","selectedNext","selectedTab","first","prev","last","_w","_t","tabPosition","selectWindowTab","what","els","getElementById","elVisible","newLayout","resolveFavIconUrl","selected","activate","rangeIndex1","rangeIndex2","neighbours","leftSibling","rightSibling","diff1","diff2","r1","r2","before","_this5","move","_this6","style","width","documentElement","alert","exportName","today","Date","y","getFullYear","m","getMonth","slice","d","getDate","h","getHours","mi","getMinutes","s","getSeconds","dataStr","encodeURIComponent","JSON","stringify","downloadAnchorNode","createElement","setAttribute","appendChild","click","evt","inputField","files","file","reader","FileReader","self","onload","event","backupFile","parse","err","error","success","newSession","catch","message","readAsText","granted","tips","Math","floor","random","element","ofElement","rect","getBoundingClientRect","top","left","right","elem","Element","Error","getComputedStyle","display","visibility","offsetWidth","offsetHeight","elemCenter","x","clientWidth","innerWidth","clientHeight","innerHeight","pointContainer","elementFromPoint","parentNode","React","Component","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","noun","suffix"],"mappings":"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","file":"TabManager.js","sourcesContent":["\"use strict\";\n\nvar browser = browser || chrome;\n\nclass TabManager extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t//this.update();\n\n\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t} else {\n\t\t\tvar check = browser.permissions.contains({ permissions: [\"system.display\"] });\n\t\t\tcheck.then(\n\t\t\t\tfunction(result) {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\t// The extension has the permissions.\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetLocalStorage(\"hideWindows\", false);\n\t\t\t\t\t\tthis.state.hideWindows = false;\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\n\t\tvar layout = \"blocks\";\n\t\tvar animations = true;\n\t\tvar windowTitles = true;\n\t\tvar compact = false;\n\t\tvar dark = false;\n\t\tvar tabactions = true;\n\t\tvar badge = true;\n\t\tvar sessionsFeature = false;\n\t\tvar hideWindows = false;\n\t\tvar filterTabs = false;\n\t\tvar tabLimit = 0;\n\t\tvar openInOwnTab = false;\n\t\tvar tabWidth = 800;\n\t\tvar tabHeight = 600;\n\n\t\tvar closeTimeout;\n\t\tvar resetTimeout;\n\n\t\tthis.state = {\n\t\t\tlayout: layout,\n\t\t\tanimations: animations,\n\t\t\twindowTitles: windowTitles,\n\t\t\ttabLimit: tabLimit,\n\t\t\topenInOwnTab: openInOwnTab,\n\t\t\ttabWidth: tabWidth,\n\t\t\ttabHeight: tabHeight,\n\t\t\tcompact: compact,\n\t\t\tdark: dark,\n\t\t\ttabactions: tabactions,\n\t\t\tbadge: badge,\n\t\t\thideWindows: hideWindows,\n\t\t\tsessionsFeature: sessionsFeature,\n\t\t\tlastOpenWindow: -1,\n\t\t\twindows: [],\n\t\t\tsessions: [],\n\t\t\tselection: {},\n\t\t\tlastSelect: false,\n\t\t\thiddenTabs: {},\n\t\t\ttabsbyid: {},\n\t\t\twindowsbyid: {},\n\t\t\tcloseTimeout: closeTimeout,\n\t\t\tresetTimeout: resetTimeout,\n\t\t\theight: 600,\n\t\t\thasScrollBar: false,\n\t\t\tfocusUpdates: 0,\n\t\t\ttopText: \"\",\n\t\t\tbottomText: \"\",\n\t\t\tlastDirection: false,\n\t\t\toptionsActive: !!this.props.optionsActive,\n\t\t\tfilterTabs: filterTabs,\n\t\t\tdupTabs: false,\n\t\t\tdragFavicon: \"\",\n\t\t\tcolorsActive: false\n\t\t};\n\n\t\tthis.addWindow = this.addWindow.bind(this);\n\t\tthis.animationsText = this.animationsText.bind(this);\n\t\tthis.badgeText = this.badgeText.bind(this);\n\t\tthis.changelayout = this.changelayout.bind(this);\n\t\tthis.changeTabHeight = this.changeTabHeight.bind(this);\n\t\tthis.changeTabLimit = this.changeTabLimit.bind(this);\n\t\tthis.changeTabWidth = this.changeTabWidth.bind(this);\n\t\tthis.checkKey = this.checkKey.bind(this);\n\t\tthis.clearSelection = this.clearSelection.bind(this);\n\t\tthis.compactText = this.compactText.bind(this);\n\t\tthis.darkText = this.darkText.bind(this);\n\t\tthis.deleteTabs = this.deleteTabs.bind(this);\n\t\tthis.discardTabs = this.discardTabs.bind(this);\n\t\tthis.donate = this.donate.bind(this);\n\t\tthis.exportSessions = this.exportSessions.bind(this);\n\t\tthis.exportSessionsText = this.exportSessionsText.bind(this);\n\t\tthis.getTip = this.getTip.bind(this);\n\t\tthis.hideText = this.hideText.bind(this);\n\t\tthis.highlightDuplicates = this.highlightDuplicates.bind(this);\n\t\tthis.hoverIcon = this.hoverIcon.bind(this);\n\t\tthis.importSessions = this.importSessions.bind(this);\n\t\tthis.importSessionsText = this.importSessionsText.bind(this);\n\t\tthis.openInOwnTabText = this.openInOwnTabText.bind(this);\n\t\tthis.pinTabs = this.pinTabs.bind(this);\n\t\tthis.rateExtension = this.rateExtension.bind(this);\n\t\tthis.scrollTo = this.scrollTo.bind(this);\n\t\tthis.search = this.search.bind(this);\n\t\tthis.sessionsText = this.sessionsText.bind(this);\n\t\tthis.sessionSync = this.sessionSync.bind(this);\n\t\tthis.tabActionsText = this.tabActionsText.bind(this);\n\t\tthis.tabHeightText = this.tabHeightText.bind(this);\n\t\tthis.tabLimitText = this.tabLimitText.bind(this);\n\t\tthis.tabWidthText = this.tabWidthText.bind(this);\n\t\tthis.toggleAnimations = this.toggleAnimations.bind(this);\n\t\tthis.toggleBadge = this.toggleBadge.bind(this);\n\t\tthis.toggleCompact = this.toggleCompact.bind(this);\n\t\tthis.toggleDark = this.toggleDark.bind(this);\n\t\tthis.toggleFilterMismatchedTabs = this.toggleFilterMismatchedTabs.bind(this);\n\t\tthis.toggleHide = this.toggleHide.bind(this);\n\t\tthis.toggleOpenInOwnTab = this.toggleOpenInOwnTab.bind(this);\n\t\tthis.toggleOptions = this.toggleOptions.bind(this);\n\t\tthis.toggleSessions = this.toggleSessions.bind(this);\n\t\tthis.toggleTabActions = this.toggleTabActions.bind(this);\n\t\tthis.toggleWindowTitles = this.toggleWindowTitles.bind(this);\n\t\tthis.update = this.update.bind(this);\n\t\tthis.windowTitlesText = this.windowTitlesText.bind(this);\n\n\t}\n\tUNSAFE_componentWillMount() {\n\t\tthis.update();\n\t}\n\n\tasync loadStorage() {\n\t\tvar layout = \"blocks\";\n\t\tvar animations = true;\n\t\tvar windowTitles = true;\n\t\tvar compact = false;\n\t\tvar dark = false;\n\t\tvar tabactions = true;\n\t\tvar badge = true;\n\t\tvar sessionsFeature = false;\n\t\tvar hideWindows = false;\n\t\tvar filterTabs = false;\n\t\tvar tabLimit = 0;\n\t\tvar openInOwnTab = false;\n\t\tvar tabWidth = 800;\n\t\tvar tabHeight = 600;\n\n\t\tvar storage = await browser.storage.local.get(null);\n\n\t\tif (!storage[\"layout\"]) storage[\"layout\"] = \"blocks\";\n\t\tif (typeof storage[\"tabLimit\"] === \"undefined\") storage[\"tabLimit\"] = 0;\n\t\tif (typeof storage[\"tabWidth\"] === \"undefined\") storage[\"tabWidth\"] = 800;\n\t\tif (typeof storage[\"tabHeight\"] === \"undefined\") storage[\"tabHeight\"] = 600;\n\n\t\tif (typeof storage[\"animations\"] === \"undefined\") storage[\"animations\"] = true;\n\t\tif (typeof storage[\"windowTitles\"] === \"undefined\") storage[\"windowTitles\"] = true;\n\t\tif (typeof storage[\"tabactions\"] === \"undefined\") storage[\"tabactions\"] = true;\n\t\tif (typeof storage[\"badge\"] === \"undefined\") storage[\"badge\"] = true;\n\n\t\tif (typeof storage[\"openInOwnTab\"] === \"undefined\") storage[\"openInOwnTab\"] = false;\n\t\tif (typeof storage[\"compact\"] === \"undefined\") storage[\"compact\"] = false;\n\t\tif (typeof storage[\"dark\"] === \"undefined\") storage[\"dark\"] = false;\n\t\tif (typeof storage[\"sessionsFeature\"] === \"undefined\") storage[\"sessionsFeature\"] = false;\n\t\tif (typeof storage[\"hideWindows\"] === \"undefined\") storage[\"hideWindows\"] = false;\n\t\tif (typeof storage[\"filter-tabs\"] === \"undefined\") storage[\"filter-tabs\"] = false;\n\n\t\tif (typeof storage[\"version\"] === \"undefined\") storage[\"version\"] = __VERSION__;\n\n\t\tlayout = storage[\"layout\"];\n\t\ttabLimit = storage[\"tabLimit\"];\n\t\ttabWidth = storage[\"tabWidth\"];\n\t\ttabHeight = storage[\"tabHeight\"];\n\t\topenInOwnTab = storage[\"openInOwnTab\"];\n\t\tanimations = storage[\"animations\"];\n\t\twindowTitles = storage[\"windowTitles\"];\n\t\tcompact = storage[\"compact\"];\n\t\tdark = storage[\"dark\"];\n\t\ttabactions = storage[\"tabactions\"];\n\t\tbadge = storage[\"badge\"];\n\t\tsessionsFeature = storage[\"sessionsFeature\"];\n\t\thideWindows = storage[\"hideWindows\"];\n\t\tfilterTabs = storage[\"filter-tabs\"];\n\n\t\tif (dark) {\n\t\t\tdocument.body.className = \"dark\";\n\t\t} else {\n\t\t\tdocument.body.className = \"\";\n\t\t}\n\n\t\tthis.setState({\n\t\t\tlayout: layout,\n\t\t\tanimations: animations,\n\t\t\twindowTitles: windowTitles,\n\t\t\ttabLimit: tabLimit,\n\t\t\topenInOwnTab: openInOwnTab,\n\t\t\ttabWidth: tabWidth,\n\t\t\ttabHeight: tabHeight,\n\t\t\tcompact: compact,\n\t\t\tdark: dark,\n\t\t\ttabactions: tabactions,\n\t\t\tbadge: badge,\n\t\t\thideWindows: hideWindows,\n\t\t\tsessionsFeature: sessionsFeature,\n\t\t\tfilterTabs: filterTabs\n\t\t});\n\t}\n\n\thoverHandler(tab) {\n\t\tthis.setState({ topText: tab.title || \"\" });\n\t\tthis.setState({ bottomText: tab.url || \"\" });\n\t\t// clearTimeout(this.state.closeTimeout);\n\t\t// this.state.closeTimeout = setTimeout(function () {\n\t\t//  window.close();\n\t\t// }, 100000);\n\t\tclearTimeout(this.state.resetTimeout);\n\t\tthis.state.resetTimeout = setTimeout(\n\t\t\tfunction() {\n\t\t\t\tthis.setState({ topText: \"\", bottomText: \"\" });\n\t\t\t\tthis.update();\n\t\t\t}.bind(this),\n\t\t\t15000\n\t\t);\n\t\t//this.update();\n\t}\n\thoverIcon(e) {\n\t\tif (e && e.nativeEvent) {\n\t\t\te.nativeEvent.preventDefault();\n\t\t\te.nativeEvent.stopPropagation();\n\t\t}\n\n\t\tvar text = \"\";\n\t\tif(e && e.target && !!e.target.title) {\n\t\t\ttext = e.target.title;\n\t\t} else if (typeof (e) == \"string\") {\n\t\t\ttext = e;\n\t\t}\n\t\tvar bottom = \" \";\n\t\tif (text.indexOf(\"\\n\") > -1) {\n\t\t\tvar a = text.split(\"\\n\");\n\t\t\ttext = a[0];\n\t\t\tbottom = a[1];\n\t\t}\n\t\tthis.setState({ topText: text });\n\t\tthis.setState({ bottomText: bottom });\n\t\t//this.update();\n\t\tthis.forceUpdate();\n\t}\n\trender() {\n\t\tvar _this = this;\n\n\t\tvar hiddenCount = this.state.hiddenCount || 0;\n\t\tvar tabCount = this.state.tabCount || 0;\n\n\t\tvar haveMin = false;\n\t\tvar haveSess = false;\n\n\t\tfor (var i = this.state.windows.length - 1; i >= 0; i--) {\n\t\t\tif (this.state.windows[i].state == \"minimized\") haveMin = true;\n\t\t}\n\n\t\tif (this.state.sessionsFeature) {\n\t\t\tif (this.state.sessions.length > 0) haveSess = true;\n\t\t\t// disable session window if we have filtering enabled\n\t\t\t// and filter active\n\t\t\tif (haveSess && this.state.filterTabs) {\n\t\t\t\tif (this.state.searchLen > 0 || Object.keys(this.state.hiddenTabs).length > 0) {\n\t\t\t\t\thaveSess = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tid=\"root\"\n\t\t\t\tclassName={\n\t\t\t\t\t(this.state.compact ? \"compact\" : \"\") +\n\t\t\t\t\t\" \" +\n\t\t\t\t\t(this.state.animations ? \"animations\" : \"no-animations\") +\n\t\t\t\t\t\" \" +\n\t\t\t\t\t(this.state.windowTitles ? \"windowTitles\" : \"no-windowTitles\")\n\t\t\t\t}\n\t\t\t\tonKeyDown={this.checkKey}\n\t\t\t\tref=\"root\"\n\t\t\t\ttabIndex={0}\n\t\t\t>\n\t\t\t\t{!this.state.optionsActive && <div className={\"window-container \" + this.state.layout} ref=\"windowcontainer\" tabIndex={2}>\n\t\t\t\t\t{this.state.windows.map(function(window) {\n\t\t\t\t\t\tif (window.state == \"minimized\") return;\n\t\t\t\t\t\tif (!!this.state.colorsActive && this.state.colorsActive !== window.id) return;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Window\n\t\t\t\t\t\t\t\tkey={\"window\" + window.id}\n\t\t\t\t\t\t\t\twindow={window}\n\t\t\t\t\t\t\t\ttabs={window.tabs}\n\t\t\t\t\t\t\t\tincognito={window.incognito}\n\t\t\t\t\t\t\t\tlayout={_this.state.layout}\n\t\t\t\t\t\t\t\tselection={_this.state.selection}\n\t\t\t\t\t\t\t\tsearchActive={_this.state.searchLen > 0}\n\t\t\t\t\t\t\t\tsessionsFeature={_this.state.sessionsFeature}\n\t\t\t\t\t\t\t\ttabactions={_this.state.tabactions}\n\t\t\t\t\t\t\t\thiddenTabs={_this.state.hiddenTabs}\n\t\t\t\t\t\t\t\tfilterTabs={_this.state.filterTabs}\n\t\t\t\t\t\t\t\thoverHandler={_this.hoverHandler.bind(_this)}\n\t\t\t\t\t\t\t\tscrollTo={_this.scrollTo.bind(_this)}\n\t\t\t\t\t\t\t\thoverIcon={_this.hoverIcon.bind(_this)}\n\t\t\t\t\t\t\t\tparentUpdate={_this.update.bind(_this)}\n\t\t\t\t\t\t\t\ttoggleColors={_this.toggleColors.bind(_this)}\n\t\t\t\t\t\t\t\ttabMiddleClick={_this.deleteTab.bind(_this)}\n\t\t\t\t\t\t\t\tselect={_this.select.bind(_this)}\n\t\t\t\t\t\t\t\tselectTo={_this.selectTo.bind(_this)}\n\t\t\t\t\t\t\t\tdraggable={true}\n\t\t\t\t\t\t\t\tdrag={_this.drag.bind(_this)}\n\t\t\t\t\t\t\t\tdrop={_this.drop.bind(_this)}\n\t\t\t\t\t\t\t\tdropWindow={_this.dropWindow.bind(_this)}\n\t\t\t\t\t\t\t\twindowTitles={_this.state.windowTitles}\n\t\t\t\t\t\t\t\tlastOpenWindow={_this.state.lastOpenWindow}\n\t\t\t\t\t\t\t\tdragFavicon={_this.dragFavicon.bind(_this)}\n\t\t\t\t\t\t\t\tref={\"window\" + window.id}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t}.bind(this))}\n\t\t\t\t\t<div className={\"hrCont \" + (!haveMin ? \"hidden\" : \"\")}>\n\t\t\t\t\t\t<div className=\"hrDiv\">\n\t\t\t\t\t\t\t<span className=\"hrSpan\">Minimized windows</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.state.windows.map(function(window) {\n\t\t\t\t\t\tif (window.state !== \"minimized\") return;\n\t\t\t\t\t\tif (!!this.state.colorsActive && this.state.colorsActive !== window.id) return;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Window\n\t\t\t\t\t\t\t\tkey={\"window\" + window.id}\n\t\t\t\t\t\t\t\twindow={window}\n\t\t\t\t\t\t\t\ttabs={window.tabs}\n\t\t\t\t\t\t\t\tincognito={window.incognito}\n\t\t\t\t\t\t\t\tlayout={_this.state.layout}\n\t\t\t\t\t\t\t\tselection={_this.state.selection}\n\t\t\t\t\t\t\t\tsearchActive={_this.state.searchLen > 0}\n\t\t\t\t\t\t\t\tsessionsFeature={_this.state.sessionsFeature}\n\t\t\t\t\t\t\t\ttabactions={_this.state.tabactions}\n\t\t\t\t\t\t\t\thiddenTabs={_this.state.hiddenTabs}\n\t\t\t\t\t\t\t\tfilterTabs={_this.state.filterTabs}\n\t\t\t\t\t\t\t\thoverHandler={_this.hoverHandler.bind(_this)}\n\t\t\t\t\t\t\t\tscrollTo={_this.scrollTo.bind(_this)}\n\t\t\t\t\t\t\t\thoverIcon={_this.hoverIcon.bind(_this)}\n\t\t\t\t\t\t\t\tparentUpdate={_this.update.bind(_this)}\n\t\t\t\t\t\t\t\ttoggleColors={_this.toggleColors.bind(_this)}\n\t\t\t\t\t\t\t\ttabMiddleClick={_this.deleteTab.bind(_this)}\n\t\t\t\t\t\t\t\tselect={_this.select.bind(_this)}\n\t\t\t\t\t\t\t\tselectTo={_this.selectTo.bind(_this)}\n\t\t\t\t\t\t\t\tdraggable={true}\n\t\t\t\t\t\t\t\tdrag={_this.drag.bind(_this)}\n\t\t\t\t\t\t\t\tdrop={_this.drop.bind(_this)}\n\t\t\t\t\t\t\t\tdropWindow={_this.dropWindow.bind(_this)}\n\t\t\t\t\t\t\t\twindowTitles={_this.state.windowTitles}\n\t\t\t\t\t\t\t\tlastOpenWindow={_this.state.lastOpenWindow}\n\t\t\t\t\t\t\t\tdragFavicon={_this.dragFavicon.bind(_this)}\n\t\t\t\t\t\t\t\tref={\"window\" + window.id}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t}.bind(this))}\n\t\t\t\t\t<div className={\"hrCont \" + (!haveSess ? \"hidden\" : \"\")}>\n\t\t\t\t\t\t<div className=\"hrDiv\">\n\t\t\t\t\t\t\t<span className=\"hrSpan\">Saved windows</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{haveSess\n\t\t\t\t\t\t? this.state.sessions.map(function(window) {\n\t\t\t\t\t\t\t\tif (!!this.state.colorsActive && this.state.colorsActive !== window.id) return;\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Session\n\t\t\t\t\t\t\t\t\t\tkey={\"session\" + window.id}\n\t\t\t\t\t\t\t\t\t\twindow={window}\n\t\t\t\t\t\t\t\t\t\ttabs={window.tabs}\n\t\t\t\t\t\t\t\t\t\tincognito={window.incognito}\n\t\t\t\t\t\t\t\t\t\tlayout={_this.state.layout}\n\t\t\t\t\t\t\t\t\t\tselection={_this.state.selection}\n\t\t\t\t\t\t\t\t\t\tsearchActive={_this.state.searchLen > 0}\n\t\t\t\t\t\t\t\t\t\ttabactions={_this.state.tabactions}\n\t\t\t\t\t\t\t\t\t\thiddenTabs={_this.state.hiddenTabs}\n\t\t\t\t\t\t\t\t\t\tfilterTabs={_this.state.filterTabs}\n\t\t\t\t\t\t\t\t\t\thoverHandler={_this.hoverHandler.bind(_this)}\n\t\t\t\t\t\t\t\t\t\tscrollTo={_this.scrollTo.bind(_this)}\n\t\t\t\t\t\t\t\t\t\thoverIcon={_this.hoverIcon.bind(_this)}\n\t\t\t\t\t\t\t\t\t\tparentUpdate={_this.update.bind(_this)}\n\t\t\t\t\t\t\t\t\t\ttoggleColors={_this.toggleColors.bind(_this)}\n\t\t\t\t\t\t\t\t\t\ttabMiddleClick={_this.deleteTab.bind(_this)}\n\t\t\t\t\t\t\t\t\t\tselect={_this.select.bind(_this)}\n\t\t\t\t\t\t\t\t\t\twindowTitles={_this.state.windowTitles}\n\t\t\t\t\t\t\t\t\t\tlastOpenWindow={_this.state.lastOpenWindow}\n\t\t\t\t\t\t\t\t\t\tref={\"session\" + window.id}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}.bind(this))\n\t\t\t\t\t\t: false}\n\t\t\t\t</div>}\n\t\t\t\t{this.state.optionsActive && <div className={\"options-container\"} ref=\"options-container\">\n\t\t\t\t\t<TabOptions\n\t\t\t\t\t\tcompact={this.state.compact}\n\t\t\t\t\t\tdark={this.state.dark}\n\t\t\t\t\t\tanimations={this.state.animations}\n\t\t\t\t\t\twindowTitles={this.state.windowTitles}\n\t\t\t\t\t\ttabLimit={this.state.tabLimit}\n\t\t\t\t\t\topenInOwnTab={this.state.openInOwnTab}\n\t\t\t\t\t\ttabWidth={this.state.tabWidth}\n\t\t\t\t\t\ttabHeight={this.state.tabHeight}\n\t\t\t\t\t\ttabactions={this.state.tabactions}\n\t\t\t\t\t\tbadge={this.state.badge}\n\t\t\t\t\t\thideWindows={this.state.hideWindows}\n\t\t\t\t\t\tsessionsFeature={this.state.sessionsFeature}\n\t\t\t\t\t\texportSessions={this.exportSessions}\n\t\t\t\t\t\timportSessions={this.importSessions}\n\t\t\t\t\t\ttoggleOpenInOwnTab={this.toggleOpenInOwnTab}\n\t\t\t\t\t\ttoggleBadge={this.toggleBadge}\n\t\t\t\t\t\ttoggleHide={this.toggleHide}\n\t\t\t\t\t\ttoggleSessions={this.toggleSessions}\n\t\t\t\t\t\ttoggleAnimations={this.toggleAnimations}\n\t\t\t\t\t\ttoggleWindowTitles={this.toggleWindowTitles}\n\t\t\t\t\t\ttoggleCompact={this.toggleCompact}\n\t\t\t\t\t\ttoggleDark={this.toggleDark}\n\t\t\t\t\t\ttoggleTabActions={this.toggleTabActions}\n\t\t\t\t\t\tchangeTabLimit={this.changeTabLimit}\n\t\t\t\t\t\tchangeTabWidth={this.changeTabWidth}\n\t\t\t\t\t\tchangeTabHeight={this.changeTabHeight}\n\t\t\t\t\t\topenInOwnTabText={this.openInOwnTabText}\n\t\t\t\t\t\tbadgeText={this.badgeText}\n\t\t\t\t\t\thideText={this.hideText}\n\t\t\t\t\t\tsessionsText={this.sessionsText}\n\t\t\t\t\t\texportSessionsText={this.exportSessionsText}\n\t\t\t\t\t\timportSessionsText={this.importSessionsText}\n\t\t\t\t\t\tanimationsText={this.animationsText}\n\t\t\t\t\t\twindowTitlesText={this.windowTitlesText}\n\t\t\t\t\t\ttabLimitText={this.tabLimitText}\n\t\t\t\t\t\ttabWidthText={this.tabWidthText}\n\t\t\t\t\t\ttabHeightText={this.tabHeightText}\n\t\t\t\t\t\tcompactText={this.compactText}\n\t\t\t\t\t\tdarkText={this.darkText}\n\t\t\t\t\t\ttabActionsText={this.tabActionsText}\n\t\t\t\t\t\tgetTip={this.getTip}\n\t\t\t\t\t/>\n\t\t\t\t</div>}\n\t\t\t\t<div className=\"window top\" ref=\"tophover\">\n\t\t\t\t\t<div className=\"icon windowaction donate\" title=\"Donate a Coffee\" onClick={this.donate} onMouseEnter={this.hoverIcon} />\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"icon windowaction rate\"\n\t\t\t\t\t\ttitle=\"Rate Tab Manager Plus\"\n\t\t\t\t\t\tonClick={this.rateExtension}\n\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"icon windowaction options\" title=\"Options\" onClick={this.toggleOptions} onMouseEnter={this.hoverIcon} />\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\tclassName=\"tabtitle\"\n\t\t\t\t\t\tref=\"topbox\"\n\t\t\t\t\t\tplaceholder={maybePluralize(tabCount, 'tab') + \" in \" + this.state.windows.length + \" windows\"}\n\t\t\t\t\t\tvalue={this.state.topText}\n\t\t\t\t\t/>\n\t\t\t\t\t<input type=\"text\" disabled={true} className=\"taburl\" ref=\"topboxurl\" placeholder={this.getTip()} value={this.state.bottomText} />\n\t\t\t\t</div>\n\t\t\t\t{!this.state.optionsActive && !this.state.colorsActive && <div className={\"window searchbox\"}>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td className=\"one\">\n\t\t\t\t\t\t\t\t\t<input className=\"searchBoxInput\" type=\"text\" placeholder=\"Start typing to search tabs...\" tabIndex=\"1\" onChange={this.search} ref=\"searchbox\" />\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td className=\"two\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName={\"icon windowaction \" + this.state.layout + \"-view\"}\n\t\t\t\t\t\t\t\t\t\ttitle={\"Change to \" + this.readablelayout(this.nextlayout()) + \" View\"}\n\t\t\t\t\t\t\t\t\t\tonClick={this.changelayout}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"icon windowaction trash\"\n\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(this.state.selection).length > 0\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Close selected tabs\\nWill close \" + maybePluralize(Object.keys(this.state.selection).length, 'tab')\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Close current Tab\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonClick={this.deleteTabs}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"icon windowaction discard\"\n\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(this.state.selection).length > 0\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Discard selected tabs\\nWill discard \" + maybePluralize(Object.keys(this.state.selection).length, 'tab') + \" - freeing memory\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Select tabs to discard them and free memory\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(this.state.selection).length > 0\n\t\t\t\t\t\t\t\t\t\t\t\t? {}\n\t\t\t\t\t\t\t\t\t\t\t\t: { opacity: 0.25 }\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonClick={this.discardTabs}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"icon windowaction pin\"\n\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(this.state.selection).length > 0\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Pin selected tabs\\nWill pin \" + maybePluralize(Object.keys(this.state.selection).length, 'tab')\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Pin current Tab\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonClick={this.pinTabs}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName={\"icon windowaction filter\" + (this.state.filterTabs ? \" enabled\" : \"\")}\n\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\t(this.state.filterTabs ? \"Turn off hiding of\" : \"Hide\") +\n\t\t\t\t\t\t\t\t\t\t\t\" tabs that do not match search\" +\n\t\t\t\t\t\t\t\t\t\t\t(this.state.searchLen > 0\n\t\t\t\t\t\t\t\t\t\t\t\t? \"\\n\" +\n\t\t\t\t\t\t\t\t\t\t\t\t\t(this.state.filterTabs ? \"Will reveal \" : \"Will hide \") +\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaybePluralize((Object.keys(this.state.tabsbyid).length - Object.keys(this.state.selection).length), 'tab')\n\t\t\t\t\t\t\t\t\t\t\t\t: \"\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonClick={this.toggleFilterMismatchedTabs}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"icon windowaction new\"\n\t\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(this.state.selection).length > 0\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Move tabs to new window\\nWill move \" + maybePluralize(Object.keys(this.state.selection).length, 'selected tab') + \" to it\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Open new empty window\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonClick={this.addWindow}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName={\"icon windowaction duplicates\" + (this.state.dupTabs ? \" enabled\" : \"\")}\n\t\t\t\t\t\t\t\t\t\ttitle=\"Highlight Duplicates\"\n\t\t\t\t\t\t\t\t\t\tonClick={this.highlightDuplicates}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.hoverIcon}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>}\n\t\t\t\t<div className=\"window placeholder\" />\n\t\t\t</div>\n\t\t);\n\t}\n\n\tasync componentDidMount()\n\t{\n\t\tawait this.loadStorage();\n\n\t\tvar _this = this;\n\n\t\tvar runUpdate = debounce(this.update, 250);\n\t\trunUpdate = runUpdate.bind(this);\n\n\t\tvar runTabUpdate = (tabid, changeinfo, tab) => {\n\t\t\tif (!!_this.refs[\"window\" + tab.windowId]) {\n\t\t\t\tvar window = _this.refs[\"window\" + tab.windowId];\n\t\t\t\tif (!!window.refs[\"tab\" + tabid]) {\n\t\t\t\t\tvar tab = window.refs[\"tab\" + tabid];\n\t\t\t\t\ttab.checkSettings();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbrowser.tabs.onCreated.addListener(runUpdate);\n\t\tbrowser.tabs.onUpdated.addListener(runUpdate);\n\t\tbrowser.tabs.onUpdated.addListener(runTabUpdate);\n\t\tbrowser.tabs.onMoved.addListener(runUpdate);\n\t\tbrowser.tabs.onRemoved.addListener(runUpdate);\n\t\tbrowser.tabs.onReplaced.addListener(runUpdate);\n\t\tbrowser.tabs.onDetached.addListener(runUpdate);\n\t\tbrowser.tabs.onAttached.addListener(runUpdate);\n\t\tbrowser.tabs.onActivated.addListener(runUpdate);\n\t\tbrowser.windows.onFocusChanged.addListener(runUpdate);\n\t\tbrowser.windows.onCreated.addListener(runUpdate);\n\t\tbrowser.windows.onRemoved.addListener(runUpdate);\n\n\t\tbrowser.runtime.onMessage.addListener(function (request, sender, sendResponse) {\n\t\t\tconsole.log(request.command);\n\t\t\tswitch (request.command) {\n\t\t\t\tcase \"refresh_windows\":\n\t\t\t\t\tfor (var window_id of request.window_ids) {\n\t\t\t\t\t\tif (!_this.refs[\"window\" + window_id]) continue;\n\t\t\t\t\t\t_this.refs[\"window\" + window_id].checkSettings();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\n\t\tbrowser.storage.onChanged.addListener(this.sessionSync);\n\n\t\tthis.sessionSync();\n\n\t\tthis.refs.root.focus();\n\t\tthis.focusRoot();\n\n\t\tvar _this = this;\n\n\t\tsetTimeout(async function() {\n\t\t\tvar scrollArea = document.getElementsByClassName(\"window-container\")[0];\n\t\t\tvar activeWindow = document.getElementsByClassName(\"activeWindow\");\n\t\t\tif (!!activeWindow && activeWindow.length > 0) {\n\t\t\t\tvar activeTab = activeWindow[0].getElementsByClassName(\"highlighted\");\n\t\t\t\tif (!!activeTab && activeTab.length > 0) {\n\t\t\t\t\tif (!!scrollArea && scrollArea.scrollTop > 0) {\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar animations = await getLocalStorage(\"animations\", false);\n\t\t\t\t\t\tactiveTab[0].scrollIntoView({ behavior: animations ? \"smooth\" : \"instant\", block: \"center\", inline: \"nearest\" });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 250);\n\n\t\t// box.select();\n\t\t// box.focus();\n\t}\n\tasync sessionSync() {\n\t\tvar values = await getLocalStorage('sessions', {});\n\t\t// console.log(values);\n\t\tvar sessions = [];\n\t\tfor (var key in values) {\n\t\t\tvar sess = values[key];\n\t\t\tif (sess.id && sess.tabs && sess.windowsInfo) {\n\t\t\t\tsessions.push(values[key]);\n\t\t\t}\n\t\t}\n\t\tthis.state.sessions = sessions;\n\t\tthis.update();\n\t}\n\tfocusRoot() {\n\t\tthis.state.focusUpdates++;\n\t\tsetTimeout(\n\t\t\tfunction() {\n\t\t\t\tif (document.activeElement == document.body) {\n\t\t\t\t\tthis.refs.root.focus();\n\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\tif (this.state.focusUpdates < 5) this.focusRoot();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\tdragFavicon(val) {\n\t\tif (!val) {\n\t\t\treturn this.state.dragFavicon;\n\t\t} else {\n\t\t\tthis.state.dragFavicon = val;\n\t\t}\n\t}\n\trateExtension() {\n\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t\tbrowser.tabs.create({ url: \"https://addons.mozilla.org/en-US/firefox/addon/tab-manager-plus-for-firefox/\" });\n\t\t} else {\n\t\t\tbrowser.tabs.create({ url: \"https://chrome.google.com/webstore/detail/tab-manager-plus-for-chro/cnkdjjdmfiffagllbiiilooaoofcoeff\" });\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\tdonate() {\n\t\tbrowser.tabs.create({ url: \"https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=67TZLSEGYQFFW\" });\n\t\tthis.forceUpdate();\n\t}\n\ttoggleOptions() {\n\t\tthis.state.optionsActive = !this.state.optionsActive;\n\t\tthis.forceUpdate();\n\t}\n\ttoggleColors(active, windowId) {\n\t\tif(!!active) {\n\t\t\tthis.state.colorsActive = windowId;\n\t\t}else{\n\t\t\tthis.state.colorsActive = false;\n\t\t}\n\t\tconsole.log(\"colorsActive\", active, windowId, this.state.colorsActive);\n\t\tthis.forceUpdate();\n\t}\n\n\tasync update() {\n\t\tvar windows = await browser.windows.getAll({ populate: true });\n\t\tvar sort_windows = await getLocalStorage(\"windowAge\", []);\n\n\t\twindows.sort(function(a, b) {\n\t\t\tvar aSort = sort_windows.indexOf(a.id);\n\t\t\tvar bSort = sort_windows.indexOf(b.id);\n\t\t\tif (a.state == \"minimized\" && b.state != \"minimized\") return 1;\n\t\t\tif (b.state == \"minimized\" && a.state != \"minimized\") return -1;\n\t\t\tif (aSort < bSort) return -1;\n\t\t\tif (aSort > bSort) return 1;\n\t\t\treturn 0;\n\t\t});\n\n\t\tthis.state.lastOpenWindow = windows[0].id;\n\t\tthis.state.windows = windows;\n\t\tthis.state.windowsbyid = {};\n\t\tthis.state.tabsbyid = {};\n\t\tvar tabCount = 0;\n\t\tfor (var i = 0; i < windows.length; i++) {\n\t\t\tvar window = windows[i];\n\t\t\tthis.state.windowsbyid[window.id] = window;\n\t\t\tfor (var j = 0; j < window.tabs.length; j++) {\n\t\t\t\tvar tab = window.tabs[j];\n\t\t\t\tthis.state.tabsbyid[tab.id] = tab;\n\t\t\t\ttabCount++;\n\t\t\t}\n\t\t}\n\t\tfor (var id in this.state.selection) {\n\t\t\tif (!this.state.tabsbyid[id]) {\n\t\t\t\tdelete this.state.selection[id];\n\t\t\t\tthis.state.lastSelect = id;\n\t\t\t}\n\t\t}\n\t\tthis.state.tabCount = tabCount;\n\t\tthis.setState({\n\t\t\ttabCount: tabCount\n\t\t});\n\t\t//this.state.searchLen = 0;\n\t\t// this.forceUpdate();\n\t}\n\tasync deleteTabs() {\n\t\tvar _this2 = this;\n\t\tvar tabs = Object.keys(this.state.selection).map(function(id) {\n\t\t\treturn _this2.state.tabsbyid[id];\n\t\t});\n\t\tif (tabs.length) {\n\t\t\tbrowser.runtime.sendMessage({command: \"close_tabs\", tabs: tabs});\n\t\t} else {\n\t\t\tvar t = await browser.tabs.query({ currentWindow: true, active: true });\n\t\t\tif (t && t.length > 0) {\n\t\t\t\tawait browser.tabs.remove(t[0].id);\n\t\t\t}\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\tdeleteTab(tabId) {\n\t\tbrowser.tabs.remove(tabId);\n\t}\n\tasync discardTabs() {\n\t\tvar _this2 = this;\n\t\tvar tabs = Object.keys(this.state.selection).map(function(id) {\n\t\t\treturn _this2.state.tabsbyid[id];\n\t\t});\n\t\tif (tabs.length) {\n\t\t\tbrowser.runtime.sendMessage({command: \"discard_tabs\", tabs: tabs});\n\t\t}\n\t\tthis.clearSelection();\n\t}\n\tdiscardTab(tabId) {\n\t\tbrowser.tabs.discard(tabId);\n\t}\n\tasync addWindow() {\n\t\tvar _this3 = this;\n\t\tvar count = Object.keys(this.state.selection).length;\n\t\tvar tabs = Object.keys(this.state.selection).map(function(id) {\n\t\t\treturn _this3.state.tabsbyid[id];\n\t\t});\n\n\t\tif (count == 0) {\n\t\t\tawait browser.windows.create({});\n\t\t} else if (count == 1) {\n\t\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t\t\tbrowser.runtime.sendMessage({command: \"focus_on_tab_and_window_delayed\", tab: tabs[0]});\n\t\t\t}else{\n\t\t\t\tbrowser.runtime.sendMessage({command: \"focus_on_tab_and_window\", tab: tabs[0]});\n\t\t\t}\n\t\t} else {\n\t\t\tbrowser.runtime.sendMessage({command: \"create_window_with_tabs\", tabs: tabs});\n\t\t}\n\t\tif (!!window.inPopup) window.close();\n\t}\n\tasync pinTabs() {\n\t\tvar _this4 = this;\n\t\tvar tabs = Object.keys(this.state.selection)\n\t\t\t.map(function(id) {\n\t\t\t\treturn _this4.state.tabsbyid[id];\n\t\t\t})\n\t\t\t.sort(function(a, b) {\n\t\t\t\treturn a.index - b.index;\n\t\t\t});\n\t\tif (tabs.length) {\n\t\t\tif (tabs[0].pinned) tabs.reverse();\n\t\t\tfor (var i = 0; i < tabs.length; i++) {\n\t\t\t\tawait browser.tabs.update(tabs[i].id, { pinned: !tabs[0].pinned });\n\t\t\t}\n\t\t} else {\n\t\t\tvar t = await browser.tabs.query({ currentWindow: true, active: true });\n\t\t\tif (t && t.length > 0) {\n\t\t\t\tawait browser.tabs.update(t[0].id, { pinned: !t[0].pinned });\n\t\t\t}\n\t\t}\n\t}\n\thighlightDuplicates(e) {\n\t\tthis.state.selection = {};\n\t\tthis.state.hiddenTabs = {};\n\t\tthis.state.searchLen = 0;\n\t\tthis.state.dupTabs = !this.state.dupTabs;\n\t\tthis.refs.searchbox.value = \"\";\n\t\tif (!this.state.dupTabs) {\n\t\t\tthis.state.hiddenCount = 0;\n\t\t\tthis.forceUpdate();\n\t\t\treturn;\n\t\t}\n\t\tvar hiddenCount = this.state.hiddenCount || 0;\n\t\tvar idList = this.state.tabsbyid;\n\t\tvar dup = [];\n\t\tfor (var id in idList) {\n\t\t\tvar tab = this.state.tabsbyid[id];\n\t\t\tfor (var id2 in idList) {\n\t\t\t\tif (id == id2) continue;\n\t\t\t\tvar tab2 = this.state.tabsbyid[id2];\n\t\t\t\tif (tab.url == tab2.url) {\n\t\t\t\t\tdup.push(id);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var id in dup) {\n\t\t\tthis.state.searchLen++;\n\t\t\thiddenCount -= this.state.hiddenTabs[dup[id]] || 0;\n\t\t\tthis.state.selection[dup[id]] = true;\n\t\t\tdelete this.state.hiddenTabs[dup[id]];\n\t\t\tthis.state.lastSelect = dup[id];\n\t\t}\n\t\tfor (var id in idList) {\n\t\t\tvar tab = this.state.tabsbyid[id];\n\t\t\tif (dup.indexOf(id) === -1) {\n\t\t\t\thiddenCount += 1 - (this.state.hiddenTabs[id] || 0);\n\t\t\t\tthis.state.hiddenTabs[id] = true;\n\t\t\t\tdelete this.state.selection[id];\n\t\t\t\tthis.state.lastSelect = id;\n\t\t\t}\n\t\t}\n\t\tif (dup.length == 0) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"No duplicates found\",\n\t\t\t\tbottomText: \" \"\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"Highlighted \" + dup.length + \" duplicate tabs\",\n\t\t\t\tbottomText: \"Press enter to move them to a new window\"\n\t\t\t});\n\t\t}\n\t\tthis.state.hiddenCount = hiddenCount;\n\t\tthis.forceUpdate();\n\t}\n\tsearch(e) {\n\t\tvar hiddenCount = this.state.hiddenCount || 0;\n\t\tvar searchQuery = e.target.value || \"\";\n\t\tvar searchLen = searchQuery.length;\n\n\t\tvar searchType = \"normal\";\n\t\tvar searchTerms = [];\n\t\tif(searchQuery.indexOf(\" \") === -1) {\n\t\t\tsearchType = \"normal\";\n\t\t}else if(searchQuery.indexOf(\" OR \") > -1) {\n\t\t\tsearchTerms = searchQuery.split(\" OR \");\n\t\t\tsearchType = \"OR\";\n\t\t}else if(searchQuery.indexOf(\" \") > -1) {\n\t\t\tsearchTerms = searchQuery.split(\" \");\n\t\t\tsearchType = \"AND\";\n\t\t}\n\t\tif(searchType != \"normal\") {\n\t\t\tsearchTerms = searchTerms.filter(function(entry) { return entry.trim() != ''; });\n\t\t}\n\n\t\tif (!searchLen) {\n\t\t\tthis.state.selection = {};\n\t\t\tthis.state.hiddenTabs = {};\n\t\t\thiddenCount = 0;\n\t\t} else {\n\t\t\tvar idList;\n\t\t\tvar lastSearchLen = this.state.searchLen;\n\t\t\tidList = this.state.tabsbyid;\n\t\t\tif(searchType == \"normal\") {\n\t\t\t\tif (!lastSearchLen) {\n\t\t\t\t\tidList = this.state.tabsbyid;\n\t\t\t\t} else if (lastSearchLen > searchLen) {\n\t\t\t\t\tidList = this.state.hiddenTabs;\n\t\t\t\t} else if (lastSearchLen < searchLen) {\n\t\t\t\t\tidList = this.state.selection;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var id in idList) {\n\t\t\t\tvar tab = this.state.tabsbyid[id];\n\t\t\t\tvar tabSearchTerm;\n\t\t\t\tif (!!tab.title) tabSearchTerm = tab.title;\n\t\t\t\tif (!!tab.url) tabSearchTerm += \" \" + tab.url;\n\t\t\t\ttabSearchTerm = tabSearchTerm.toLowerCase();\n\t\t\t\tvar match = false;\n\t\t\t\tif(searchType == \"normal\") {\n\t\t\t\t\tmatch = (tabSearchTerm.indexOf(e.target.value.toLowerCase()) >= 0);\n\t\t\t\t}else if(searchType == \"OR\") {\n\t\t\t\t\tfor (var searchOR of searchTerms) {\n\t\t\t\t\t\tsearchOR = searchOR.trim().toLowerCase();\n\t\t\t\t\t\tif(tabSearchTerm.indexOf(searchOR) >= 0) {\n\t\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(searchType == \"AND\") {\n\t\t\t\t\tvar andMatch = true;\n\t\t\t\t\tfor (var searchAND of searchTerms) {\n\t\t\t\t\t\tsearchAND = searchAND.trim().toLowerCase();\n\t\t\t\t\t\tif(tabSearchTerm.indexOf(searchAND) >= 0) {\n\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tandMatch = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmatch = andMatch;\n\t\t\t\t}\n\t\t\t\tif (match) {\n\t\t\t\t\thiddenCount -= this.state.hiddenTabs[id] || 0;\n\t\t\t\t\tthis.state.selection[id] = true;\n\t\t\t\t\tdelete this.state.hiddenTabs[id];\n\t\t\t\t\tthis.state.lastSelect = id;\n\t\t\t\t} else {\n\t\t\t\t\thiddenCount += 1 - (this.state.hiddenTabs[id] || 0);\n\t\t\t\t\tthis.state.hiddenTabs[id] = true;\n\t\t\t\t\tdelete this.state.selection[id];\n\t\t\t\t\tthis.state.lastSelect = id;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.state.hiddenCount = hiddenCount;\n\t\tthis.state.searchLen = searchLen;\n\t\tvar matches = Object.keys(this.state.selection).length;\n\t\tvar matchtext = \"\";\n\t\tif (matches == 0 && searchLen > 0) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"No matches for '\" + searchQuery + \"'\",\n\t\t\t\tbottomText: \"\"\n\t\t\t});\n\t\t} else if (matches == 0) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"\",\n\t\t\t\tbottomText: \"\"\n\t\t\t});\n\t\t} else if (matches > 1) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: Object.keys(this.state.selection).length + \" matches for '\" + searchQuery + \"'\",\n\t\t\t\tbottomText: \"Press enter to move them to a new window\"\n\t\t\t});\n\t\t} else if (matches == 1) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: Object.keys(this.state.selection).length + \" match for '\" + searchQuery + \"'\",\n\t\t\t\tbottomText: \"Press enter to switch to the tab\"\n\t\t\t});\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\tclearSelection() {\n\t\tthis.state.selection = {};\n\t\tthis.setState({\n\t\t\tlastSelect: false\n\t\t});\n\t}\n\tcheckKey(e) {\n\t\t// enter\n\t\tif (e.keyCode == 13) this.addWindow();\n\t\t// escape key\n\t\tif (e.keyCode == 27) {\n\t\t\tif(this.state.searchLen > 0 || Object.keys(this.state.selection).length > 0) {\n\t\t\t\t// stop popup from closing if we have search text or selection active\n\t\t\t\te.nativeEvent.preventDefault();\n\t\t\t\te.nativeEvent.stopPropagation();\n\t\t\t}\n\t\t\tthis.state.hiddenTabs = {};\n\t\t\tthis.state.searchLen = 0;\n\t\t\tthis.refs.searchbox.value = \"\";\n\t\t\tthis.clearSelection();\n\t\t}\n\t\t// any typed keys\n\t\tif (\n\t\t\t(e.keyCode >= 48 && e.keyCode <= 57) ||\n\t\t\t(e.keyCode >= 65 && e.keyCode <= 90) ||\n\t\t\t(e.keyCode >= 186 && e.keyCode <= 192) ||\n\t\t\t(e.keyCode >= 219 && e.keyCode <= 22) ||\n\t\t\te.keyCode == 8 ||\n\t\t\te.keyCode == 46 ||\n\t\t\te.keyCode == 32\n\t\t) {\n\t\t\tif (document.activeElement != this.refs.searchbox) {\n\t\t\t\tif (document.activeElement.type != \"text\" && document.activeElement.type != \"input\") {\n\t\t\t\t\tthis.refs.searchbox.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// arrow keys\n\t\t/*\n\t\t\tleft arrow  37\n\t\t\tup arrow  38\n\t\t\tright arrow 39\n\t\t\tdown arrow  40\n\t\t*/\n\t\tif (e.keyCode >= 37 && e.keyCode <= 40) {\n\t\t\tif (document.activeElement != this.refs.windowcontainer && document.activeElement != this.refs.searchbox) {\n\t\t\t\tthis.refs.windowcontainer.focus();\n\t\t\t}\n\n\t\t\tif (document.activeElement != this.refs.searchbox || !this.refs.searchbox.value) {\n\t\t\t\tvar goLeft = e.keyCode == 37;\n\t\t\t\tvar goRight = e.keyCode == 39;\n\t\t\t\tvar goUp = e.keyCode == 38;\n\t\t\t\tvar goDown = e.keyCode == 40;\n\t\t\t\tif (this.state.layout == \"vertical\") {\n\t\t\t\t\tgoLeft = e.keyCode == 38;\n\t\t\t\t\tgoRight = e.keyCode == 40;\n\t\t\t\t\tgoUp = e.keyCode == 37;\n\t\t\t\t\tgoDown = e.keyCode == 39;\n\t\t\t\t}\n\t\t\t\tif (goLeft || goRight || goUp || goDown) {\n\t\t\t\t\te.nativeEvent.preventDefault();\n\t\t\t\t\te.nativeEvent.stopPropagation();\n\t\t\t\t}\n\t\t\t\tvar altKey = e.nativeEvent.metaKey || e.nativeEvent.altKey || e.nativeEvent.shiftKey || e.nativeEvent.ctrlKey;\n\t\t\t\tif (goLeft || goRight) {\n\t\t\t\t\tvar selectedTabs = Object.keys(this.state.selection);\n\t\t\t\t\tif (!altKey && selectedTabs.length > 1) {\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar found = false;\n\t\t\t\t\t\tvar selectedNext = false;\n\t\t\t\t\t\tvar selectedTab = false;\n\t\t\t\t\t\tvar first = false;\n\t\t\t\t\t\tvar prev = false;\n\t\t\t\t\t\tvar last = false;\n\t\t\t\t\t\tif (selectedTabs.length == 1) {\n\t\t\t\t\t\t\tselectedTab = selectedTabs[0];\n\t\t\t\t\t\t\t// console.log(\"one tab\", selectedTab);\n\t\t\t\t\t\t} else if (selectedTabs.length > 1) {\n\t\t\t\t\t\t\tif (this.state.lastSelect) {\n\t\t\t\t\t\t\t\tselectedTab = this.state.lastSelect;\n\t\t\t\t\t\t\t\t// console.log(\"more tabs, last\", selectedTab);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tselectedTab = selectedTabs[0];\n\t\t\t\t\t\t\t\t// console.log(\"more tabs, first\", selectedTab);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (selectedTabs.length == 0 && this.state.lastSelect) {\n\t\t\t\t\t\t\tselectedTab = this.state.lastSelect;\n\t\t\t\t\t\t\t// console.log(\"no tabs, last\", selectedTab);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.state.lastDirection) {\n\t\t\t\t\t\t\tif (goRight && this.state.lastDirection == \"goRight\") {\n\t\t\t\t\t\t\t} else if (goLeft && this.state.lastDirection == \"goLeft\") {\n\t\t\t\t\t\t\t} else if (selectedTabs.length > 1) {\n\t\t\t\t\t\t\t\t// console.log(\"turned back, last\", this.state.lastSelect, selectedTab);\n\t\t\t\t\t\t\t\tthis.select(this.state.lastSelect);\n\t\t\t\t\t\t\t\tthis.state.lastDirection = false;\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.state.lastDirection = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!this.state.lastDirection) {\n\t\t\t\t\t\t\tif (goRight) this.state.lastDirection = \"goRight\";\n\t\t\t\t\t\t\tif (goLeft) this.state.lastDirection = \"goLeft\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var _w of this.state.windows) {\n\t\t\t\t\t\t\tif (found) break;\n\t\t\t\t\t\t\tif (_w.state != \"minimized\") {\n\t\t\t\t\t\t\t\tfor (var _t of _w.tabs) {\n\t\t\t\t\t\t\t\t\tlast = _t.id;\n\t\t\t\t\t\t\t\t\tif (!first) first = _t.id;\n\t\t\t\t\t\t\t\t\tif (!selectedTab) {\n\t\t\t\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\t\t\t\tthis.select(_t.id);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else if (selectedTab == _t.id) {\n\t\t\t\t\t\t\t\t\t\t// console.log(\"select next one\", selectedNext);\n\t\t\t\t\t\t\t\t\t\tif (goRight) {\n\t\t\t\t\t\t\t\t\t\t\tselectedNext = true;\n\t\t\t\t\t\t\t\t\t\t} else if (prev) {\n\t\t\t\t\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\t\t\t\t\tthis.select(prev);\n\t\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if (selectedNext) {\n\t\t\t\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\t\t\t\tthis.select(_t.id);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tprev = _t.id;\n\t\t\t\t\t\t\t\t\t// console.log(_t, _t.id == selectedTab);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var _w of this.state.windows) {\n\t\t\t\t\t\t\tif (found) break;\n\t\t\t\t\t\t\tif (_w.state == \"minimized\") {\n\t\t\t\t\t\t\t\tfor (var _t of _w.tabs) {\n\t\t\t\t\t\t\t\t\tlast = _t.id;\n\t\t\t\t\t\t\t\t\tif (!first) first = _t.id;\n\t\t\t\t\t\t\t\t\tif (!selectedTab) {\n\t\t\t\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\t\t\t\tthis.select(_t.id);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else if (selectedTab == _t.id) {\n\t\t\t\t\t\t\t\t\t\tif (goRight) {\n\t\t\t\t\t\t\t\t\t\t\tselectedNext = true;\n\t\t\t\t\t\t\t\t\t\t} else if (prev) {\n\t\t\t\t\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\t\t\t\t\tthis.select(prev);\n\t\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if (selectedNext) {\n\t\t\t\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\t\t\t\tthis.select(_t.id);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tprev = _t.id;\n\t\t\t\t\t\t\t\t\t// console.log(_t, _t.id == selectedTab);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!found && goRight && first) {\n\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\tthis.select(first);\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!found && goLeft && last) {\n\t\t\t\t\t\t\tif (!altKey) this.state.selection = {};\n\t\t\t\t\t\t\tthis.select(last);\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (goUp || goDown) {\n\t\t\t\t\tvar selectedTabs = Object.keys(this.state.selection);\n\t\t\t\t\tif (selectedTabs.length > 1) {\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar found = false;\n\t\t\t\t\t\tvar selectedNext = false;\n\t\t\t\t\t\tvar selectedTab = -1;\n\t\t\t\t\t\tvar first = false;\n\t\t\t\t\t\tvar prev = false;\n\t\t\t\t\t\tvar last = false;\n\t\t\t\t\t\tvar tabPosition = -1;\n\t\t\t\t\t\tvar i = -1;\n\t\t\t\t\t\tif (selectedTabs.length == 1) {\n\t\t\t\t\t\t\tselectedTab = selectedTabs[0];\n\t\t\t\t\t\t\t// console.log(selectedTab);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var _w of this.state.windows) {\n\t\t\t\t\t\t\ti = 0;\n\t\t\t\t\t\t\tif (found) break;\n\t\t\t\t\t\t\tif (_w.state != \"minimized\") {\n\t\t\t\t\t\t\t\tif (!first) first = _w.id;\n\t\t\t\t\t\t\t\tfor (var _t of _w.tabs) {\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\tlast = _w.id;\n\t\t\t\t\t\t\t\t\tif (!selectedTab) {\n\t\t\t\t\t\t\t\t\t\tthis.selectWindowTab(_w.id, tabPosition);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else if (selectedTab == _t.id) {\n\t\t\t\t\t\t\t\t\t\ttabPosition = i;\n\t\t\t\t\t\t\t\t\t\t// console.log(\"found tab\", _w.id, _t.id, selectedTab, i);\n\t\t\t\t\t\t\t\t\t\tif (goDown) {\n\t\t\t\t\t\t\t\t\t\t\t// console.log(\"select next window \", selectedNext, tabPosition);\n\t\t\t\t\t\t\t\t\t\t\tselectedNext = true;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t} else if (prev) {\n\t\t\t\t\t\t\t\t\t\t\t// console.log(\"select prev window \", prev, tabPosition);\n\t\t\t\t\t\t\t\t\t\t\tthis.selectWindowTab(prev, tabPosition);\n\t\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if (selectedNext) {\n\t\t\t\t\t\t\t\t\t\t// console.log(\"selecting next window \", _w.id, tabPosition);\n\t\t\t\t\t\t\t\t\t\tthis.selectWindowTab(_w.id, tabPosition);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// console.log(_t, _t.id == selectedTab);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tprev = _w.id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var _w of this.state.windows) {\n\t\t\t\t\t\t\ti = 0;\n\t\t\t\t\t\t\tif (found) break;\n\t\t\t\t\t\t\tif (_w.state == \"minimized\") {\n\t\t\t\t\t\t\t\tif (!first) first = _w.id;\n\t\t\t\t\t\t\t\tfor (var _t of _w.tabs) {\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\tlast = _w.id;\n\t\t\t\t\t\t\t\t\tif (!selectedTab) {\n\t\t\t\t\t\t\t\t\t\tthis.selectWindowTab(_w.id, tabPosition);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else if (selectedTab == _t.id) {\n\t\t\t\t\t\t\t\t\t\ttabPosition = i;\n\t\t\t\t\t\t\t\t\t\t// console.log(\"found tab\", _w.id, _t.id, selectedTab, i);\n\t\t\t\t\t\t\t\t\t\tif (goDown) {\n\t\t\t\t\t\t\t\t\t\t\t// console.log(\"select next window \", selectedNext, tabPosition);\n\t\t\t\t\t\t\t\t\t\t\tselectedNext = true;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t} else if (prev) {\n\t\t\t\t\t\t\t\t\t\t\t// console.log(\"select prev window \", prev, tabPosition);\n\t\t\t\t\t\t\t\t\t\t\tthis.selectWindowTab(prev, tabPosition);\n\t\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if (selectedNext) {\n\t\t\t\t\t\t\t\t\t\t// console.log(\"selecting next window \", _w.id, tabPosition);\n\t\t\t\t\t\t\t\t\t\tthis.selectWindowTab(_w.id, tabPosition);\n\t\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// console.log(_t, _t.id == selectedTab);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tprev = _w.id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log(found, goDown, first);\n\t\t\t\t\t\tif (!found && goDown && first) {\n\t\t\t\t\t\t\t// console.log(\"go first\", first);\n\t\t\t\t\t\t\tthis.state.selection = {};\n\t\t\t\t\t\t\tthis.selectWindowTab(first, tabPosition);\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log(found, goUp, last);\n\t\t\t\t\t\tif (!found && goUp && last) {\n\t\t\t\t\t\t\t// console.log(\"go last\", last);\n\t\t\t\t\t\t\tthis.state.selection = {};\n\t\t\t\t\t\t\tthis.selectWindowTab(last, tabPosition);\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// page up / page down\n\t\tif (e.keyCode == 33 || e.keyCode == 34) {\n\t\t\tif (document.activeElement != this.refs.windowcontainer) {\n\t\t\t\tthis.refs.windowcontainer.focus();\n\t\t\t}\n\t\t}\n\t}\n\tselectWindowTab(windowId, tabPosition) {\n\t\tif (!tabPosition || tabPosition < 1) tabPosition = 1;\n\t\tfor (var _w of this.state.windows) {\n\t\t\tif (_w.id != windowId) continue;\n\t\t\tvar i = 0;\n\t\t\tfor (var _t of _w.tabs) {\n\t\t\t\ti++;\n\t\t\t\tif ((_w.tabs.length >= tabPosition && tabPosition == i) || (_w.tabs.length < tabPosition && _w.tabs.length == i)) {\n\t\t\t\t\tthis.state.selection = {};\n\t\t\t\t\tthis.select(_t.id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tscrollTo(what, id) {\n\t\tvar els = document.getElementById(what + \"-\" + id);\n\t\tif (!!els) {\n\t\t\tif (!this.elVisible(els)) {\n\t\t\t\tels.scrollIntoView({ behavior: this.state.animations ? \"smooth\" : \"instant\", block: \"center\", inline: \"nearest\" });\n\t\t\t}\n\t\t}\n\t}\n\tasync changelayout(layout) {\n\t\tvar newLayout;\n\t\tif (layout && typeof (layout) == \"string\") {\n\t\t\tnewLayout = layout;\n\t\t} else {\n\t\t\tif (this.state.layout == \"blocks\") {\n\t\t\t\tnewLayout = this.state.layout = \"blocks-big\";\n\t\t\t} else if (this.state.layout == \"blocks-big\") {\n\t\t\t\tnewLayout = this.state.layout = \"horizontal\";\n\t\t\t} else if (this.state.layout == \"horizontal\") {\n\t\t\t\tnewLayout = this.state.layout = \"vertical\";\n\t\t\t} else {\n\t\t\t\tnewLayout = this.state.layout = \"blocks\";\n\t\t\t}\n\t\t}\n\t\tthis.state.layout = newLayout;\n\t\tawait setLocalStorage(\"layout\", newLayout);\n\n\t\tthis.setState({\n\t\t\tlayout: newLayout,\n\t\t\ttopText: \"Switched to \" + this.readablelayout(this.state.layout) + \" view\",\n\t\t\tbottomText: \" \"\n\t\t});\n\n\t\tthis.forceUpdate();\n\t}\n\tnextlayout() {\n\t\tif (this.state.layout == \"blocks\") {\n\t\t\treturn \"blocks-big\";\n\t\t} else if (this.state.layout == \"blocks-big\") {\n\t\t\treturn \"horizontal\";\n\t\t} else if (this.state.layout == \"horizontal\") {\n\t\t\treturn \"vertical\";\n\t\t} else {\n\t\t\treturn \"blocks\";\n\t\t}\n\t}\n\treadablelayout(layout) {\n\t\tif (layout == \"blocks\") {\n\t\t\treturn \"Block\";\n\t\t} else if (layout == \"blocks-big\") {\n\t\t\treturn \"Big Block\";\n\t\t} else if (layout == \"horizontal\") {\n\t\t\treturn \"Horizontal\";\n\t\t} else {\n\t\t\treturn \"Vertical\";\n\t\t}\n\t}\n\tselect(id) {\n\t\tif (this.state.selection[id]) {\n\t\t\tdelete this.state.selection[id];\n\t\t\tthis.setState({\n\t\t\t\tlastSelect: id\n\t\t\t});\n\t\t} else {\n\t\t\tthis.state.selection[id] = true;\n\t\t\tthis.setState({\n\t\t\t\tlastSelect: id\n\t\t\t});\n\t\t}\n\t\tthis.scrollTo('tab', id);\n\t\tvar tab = this.state.tabsbyid[id];\n\t\tif(this.refs['window' + tab.windowId] && this.refs['window' + tab.windowId].refs['tab' + id]) {\n\t\t\tthis.refs['window' + tab.windowId].refs['tab' + id].resolveFavIconUrl();\n\t\t}\n\n\t\tvar selected = Object.keys(this.state.selection).length;\n\t\tif (selected == 0) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"No tabs selected\",\n\t\t\t\tbottomText: \" \"\n\t\t\t});\n\t\t} else if (selected == 1) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"Selected \" + selected + \" tab\",\n\t\t\t\tbottomText: \"Press enter to switch to it\"\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"Selected \" + selected + \" tabs\",\n\t\t\t\tbottomText: \"Press enter to move them to a new window\"\n\t\t\t});\n\t\t}\n\t}\n\tselectTo(id, tabs) {\n\t\tvar activate = false;\n\t\tvar lastSelect = this.state.lastSelect;\n\t\tif (id == lastSelect) {\n\t\t\tthis.select(id);\n\t\t\treturn;\n\t\t}\n\t\tif (!!lastSelect) {\n\t\t\tif (this.state.selection[lastSelect]) {\n\t\t\t\tactivate = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.state.selection[id]) {\n\t\t\t\tactivate = false;\n\t\t\t} else {\n\t\t\t\tactivate = true;\n\t\t\t}\n\t\t}\n\n\t\tvar rangeIndex1;\n\t\tvar rangeIndex2;\n\t\tfor (var i = 0; i < tabs.length; i++) {\n\t\t\tif (tabs[i].id == id) {\n\t\t\t\trangeIndex1 = i;\n\t\t\t}\n\t\t\tif (!!lastSelect && tabs[i].id == lastSelect) {\n\t\t\t\trangeIndex2 = i;\n\t\t\t}\n\t\t}\n\t\tif (!!lastSelect && !rangeIndex2) {\n\t\t\tthis.select(id);\n\t\t\treturn;\n\t\t}\n\t\tif (!rangeIndex2) {\n\t\t\tvar neighbours = [];\n\t\t\tfor (var i = 0; i < tabs.length; i++) {\n\t\t\t\tvar tabId = tabs[i].id;\n\t\t\t\tif (tabId != id) {\n\t\t\t\t\tif (this.state.selection[tabId]) {\n\t\t\t\t\t\tneighbours.push(tabId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (activate) {\n\t\t\t\t// find closest selected item that's not connected\n\t\t\t\tvar leftSibling = 0;\n\t\t\t\tvar rightSibling = tabs.length - 1;\n\t\t\t\tfor (var i = 0; i < rangeIndex1; i++) {\n\t\t\t\t\tif (neighbours.indexOf(i) > -1) {\n\t\t\t\t\t\tleftSibling = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (var i = tabs.length - 1; i > rangeIndex1; i--) {\n\t\t\t\t\tif (neighbours.indexOf(i) > -1) {\n\t\t\t\t\t\trightSibling = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar diff1 = rangeIndex1 - leftSibling;\n\t\t\t\tvar diff2 = rightSibling - rangeIndex1;\n\t\t\t\tif (diff1 > diff2) {\n\t\t\t\t\trangeIndex2 = rightSibling;\n\t\t\t\t} else {\n\t\t\t\t\trangeIndex2 = leftSibling;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// find furthest selected item that's connected\n\t\t\t\tvar leftSibling = rangeIndex1;\n\t\t\t\tvar rightSibling = rangeIndex1;\n\t\t\t\tfor (var i = rangeIndex1; i > 0; i--) {\n\t\t\t\t\tif (neighbours.indexOf(i) > -1) {\n\t\t\t\t\t\tleftSibling = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (var i = rangeIndex1; i < tabs.length; i++) {\n\t\t\t\t\tif (neighbours.indexOf(i) > -1) {\n\t\t\t\t\t\trightSibling = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar diff1 = rangeIndex1 - leftSibling;\n\t\t\t\tvar diff2 = rightSibling - rangeIndex1;\n\t\t\t\tif (diff1 > diff2) {\n\t\t\t\t\trangeIndex2 = leftSibling;\n\t\t\t\t} else {\n\t\t\t\t\trangeIndex2 = rightSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.setState({\n\t\t\tlastSelect: tabs[rangeIndex2].id\n\t\t});\n\t\tif (rangeIndex2 < rangeIndex1) {\n\t\t\tvar r1 = rangeIndex2;\n\t\t\tvar r2 = rangeIndex1;\n\t\t\trangeIndex1 = r1;\n\t\t\trangeIndex2 = r2;\n\t\t}\n\n\t\tfor (var i = 0; i < tabs.length; i++) {\n\t\t\tif (i >= rangeIndex1 && i <= rangeIndex2) {\n\t\t\t\tvar tabId = tabs[i].id;\n\t\t\t\tif (activate) {\n\t\t\t\t\tthis.state.selection[tabId] = true;\n\t\t\t\t} else {\n\t\t\t\t\tdelete this.state.selection[tabId];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.scrollTo('tab', this.state.lastSelect);\n\n\t\tvar selected = Object.keys(this.state.selection).length;\n\t\tif (selected == 0) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"No tabs selected\",\n\t\t\t\tbottomText: \" \"\n\t\t\t});\n\t\t} else if (selected == 1) {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"Selected \" + selected + \" tab\",\n\t\t\t\tbottomText: \"Press enter to switch to it\"\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\ttopText: \"Selected \" + selected + \" tabs\",\n\t\t\t\tbottomText: \"Press enter to move them to a new window\"\n\t\t\t});\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\tdrag(e, id) {\n\t\tif (!this.state.selection[id]) {\n\t\t\tthis.state.selection = {};\n\t\t\tthis.state.selection[id] = true;\n\t\t\tthis.state.lastSelect = id;\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\tasync drop(id, before) {\n\t\tvar _this5 = this;\n\t\tvar tab = this.state.tabsbyid[id];\n\t\tvar tabs = Object.keys(this.state.selection).map(function(id) {\n\t\t\treturn _this5.state.tabsbyid[id];\n\t\t});\n\t\tvar index = tab.index + (before ? 0 : 1);\n\n\t\tfor (var i = 0; i < tabs.length; i++) {\n\t\t\tvar t = tabs[i];\n\t\t\tawait browser.tabs.move(t.id, { windowId: tab.windowId, index: index });\n\t\t\tawait browser.tabs.update(t.id, { pinned: t.pinned });\n\t\t}\n\t\tthis.setState({\n\t\t\tselection: {}\n\t\t});\n\t\tthis.update();\n\t}\n\tasync dropWindow(windowId) {\n\t\tvar _this6 = this;\n\t\tvar tabs = Object.keys(this.state.selection).map(function(id) {\n\t\t\treturn _this6.state.tabsbyid[id];\n\t\t});\n\n\t\tbrowser.runtime.sendMessage({command: \"move_tabs_to_window\", window_id: windowId, tabs: tabs});\n\n\t\tthis.setState({\n\t\t\tselection: {}\n\t\t});\n\t}\n\tasync changeTabLimit(e) {\n\t\tthis.state.tabLimit = e.target.value;\n\t\tawait setLocalStorage(\"tabLimit\", this.state.tabLimit);\n\t\tthis.tabLimitText();\n\t\tthis.forceUpdate();\n\t}\n\ttabLimitText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Limit the number of tabs per window. Will move new tabs into a new window instead. 0 to turn off\"\n\t\t});\n\t}\n\tasync changeTabWidth(e) {\n\t\tthis.state.tabWidth = e.target.value;\n\t\tawait setLocalStorage(\"tabWidth\", this.state.tabWidth);\n\t\tdocument.body.style.width = this.state.tabWidth + \"px\";\n\t\tthis.tabWidthText();\n\t\tthis.forceUpdate();\n\t}\n\ttabWidthText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Change the width of this window. 800 by default.\"\n\t\t});\n\t}\n\tasync changeTabHeight(e) {\n\t\tthis.state.tabHeight = e.target.value;\n\t\tawait setLocalStorage(\"tabHeight\", this.state.tabHeight);\n\t\tdocument.body.style.height = this.state.tabHeight + \"px\";\n\t\tthis.tabHeightText();\n\t\tthis.forceUpdate();\n\t}\n\ttabHeightText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Change the height of this window. 600 by default.\"\n\t\t});\n\t}\n\tasync toggleAnimations() {\n\t\tthis.state.animations = !this.state.animations;\n\t\tawait setLocalStorage(\"animations\", this.state.animations);\n\t\tthis.animationsText();\n\t\tthis.forceUpdate();\n\t}\n\tanimationsText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Enables/disables animations. Default : on\"\n\t\t});\n\t}\n\tasync toggleWindowTitles() {\n\t\tthis.state.windowTitles = !this.state.windowTitles;\n\t\tawait setLocalStorage(\"windowTitles\", this.state.windowTitles);\n\t\tthis.windowTitlesText();\n\t\tthis.forceUpdate();\n\t}\n\twindowTitlesText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Enables/disables window titles. Default : on\"\n\t\t});\n\t}\n\tasync toggleCompact() {\n\t\tthis.state.compact = !this.state.compact;\n\t\tawait setLocalStorage(\"compact\", this.state.compact);\n\t\tthis.compactText();\n\t\tthis.forceUpdate();\n\t}\n\tcompactText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Compact mode is a more compressed layout. Default : off\"\n\t\t});\n\t}\n\tasync toggleDark() {\n\t\tthis.state.dark = !this.state.dark;\n\t\tawait setLocalStorage(\"dark\", this.state.dark);\n\t\tthis.darkText();\n\t\tif (this.state.dark) {\n\t\t\tdocument.body.className = \"dark\";\n\t\t\tdocument.documentElement.className = \"dark\";\n\t\t} else {\n\t\t\tdocument.body.className = \"\";\n\t\t\tdocument.documentElement.className = \"\";\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\tdarkText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Dark mode inverts the layout - better on the eyes. Default : off\"\n\t\t});\n\t}\n\tasync toggleTabActions() {\n\t\tthis.state.tabactions = !this.state.tabactions;\n\t\tawait setLocalStorage(\"tabactions\", this.state.tabactions);\n\t\tthis.tabActionsText();\n\t\tthis.forceUpdate();\n\t}\n\ttabActionsText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Adds 'Open a new tab' and 'Close this window' option to each window. Default : on\"\n\t\t});\n\t}\n\tasync toggleBadge() {\n\t\tthis.state.badge = !this.state.badge;\n\t\tawait setLocalStorage(\"badge\", this.state.badge);\n\t\tthis.badgeText();\n\t\tbrowser.runtime.sendMessage({command: \"update_tab_count\"});\n\t\tthis.forceUpdate();\n\t}\n\tbadgeText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Shows the number of open tabs on the Tab Manager icon. Default : on\"\n\t\t});\n\t}\n\tasync toggleOpenInOwnTab() {\n\t\tthis.state.openInOwnTab = !this.state.openInOwnTab;\n\t\tawait setLocalStorage(\"openInOwnTab\", this.state.openInOwnTab);\n\t\tthis.openInOwnTabText();\n\t\tbrowser.runtime.sendMessage({ command: \"reload_popup_controls\" });\n\t\tthis.forceUpdate();\n\t}\n\topenInOwnTabText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Open the Tab Manager by default in own tab, or as a popup?\"\n\t\t});\n\t}\n\tasync toggleSessions() {\n\t\tthis.state.sessionsFeature = !this.state.sessionsFeature;\n\t\tawait setLocalStorage(\"sessionsFeature\", this.state.sessionsFeature);\n\t\tthis.sessionsText();\n\t\tthis.forceUpdate();\n\t}\n\tsessionsText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Allows you to save/restore windows into sessions. ( Tab History will be lost ) Default : off\"\n\t\t});\n\t}\n\texportSessions() {\n\t\tif (this.state.sessions.length == 0) {\n\t\t\twindow.alert(\"You have currently no windows saved for later. There is nothing to export.\");\n\t\t\treturn;\n\t\t}\n\t\tvar exportName = \"tab-manager-plus-backup\";\n\t\tvar today = new Date();\n\t\tvar y = today.getFullYear();\n\t\t// JavaScript months are 0-based.\n\t\tvar m = (\"0\" + (today.getMonth() + 1)).slice(-2);\n\t\tvar d = (\"0\" + today.getDate()).slice(-2);\n\t\tvar h = (\"0\" + today.getHours()).slice(-2);\n\t\tvar mi = (\"0\" + today.getMinutes()).slice(-2);\n\t\tvar s = (\"0\" + today.getSeconds()).slice(-2);\n\t\texportName += \"-\" + y + m + d + \"-\" + h + mi + \"-\" + s;\n\t\tvar dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(this.state.sessions, null, 2));\n\t\tvar downloadAnchorNode = document.createElement(\"a\");\n\t\tdownloadAnchorNode.setAttribute(\"href\", dataStr);\n\t\tdownloadAnchorNode.setAttribute(\"download\", exportName + \".json\");\n\t\tdocument.body.appendChild(downloadAnchorNode); // required for firefox\n\t\tdownloadAnchorNode.click();\n\t\tdownloadAnchorNode.remove();\n\t\tthis.exportSessionsText();\n\t\tthis.forceUpdate();\n\t}\n\texportSessionsText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Allows you to export your saved windows to an external backup\"\n\t\t});\n\t}\n\timportSessions(evt) {\n\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t\tif(window.inPopup) {\n\t\t\t\twindow.alert(\"Due to a Firefox bug session import does not work in the popup. Please use the options screen or open Tab Manager Plus in its' own tab\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\ttry {\n\t\t\tlet inputField = evt.target; // #session_import\n\t\t\tlet files = evt.target.files;\n\t\t\tif (!files.length) {\n\t\t\t\talert(\"No file selected!\");\n\t\t\t\tthis.setState({ bottomText: \"Error: Could not read the backup file!\" });\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet file = files[0];\n\t\t\tlet reader = new FileReader();\n\t\t\tconst self = this;\n\t\t\treader.onload = async event => {\n\t\t\t\t//console.log('FILE CONTENT', event.target.result);\n\t\t\t\tvar backupFile;\n\t\t\t\ttry {\n\t\t\t\t\tbackupFile = JSON.parse(event.target.result);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\twindow.alert(err);\n\t\t\t\t\tthis.setState({ bottomText: \"Error: Could not read the backup file!\" });\n\t\t\t\t}\n\t\t\t\tif (!!backupFile && backupFile.length > 0) {\n\t\t\t\t\tvar success = backupFile.length;\n\t\t\t\t\tfor (var i = 0; i < backupFile.length; i++) {\n\t\t\t\t\t\tvar newSession = backupFile[i];\n\t\t\t\t\t\tif (newSession.windowsInfo && newSession.tabs && newSession.id) {\n\t\t\t\t\t\t\tvar sessions = await getLocalStorage('sessions', {});\n\t\t\t\t\t\t\tsessions[newSession.id] = newSession;\n\t\t\t\t\t\t\t//this.state.sessions.push(obj);\n\n\t\t\t\t\t\t\tvar value = await setLocalStorage('sessions', sessions).catch(function(err) {\n\t\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t\t\tconsole.error(err.message);\n\t\t\t\t\t\t\t\tsuccess--;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t//console.log(value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.setState({ bottomText: success + \" windows successfully restored!\" });\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({ bottomText: \"Error: Could not restore any windows from the backup file!\" });\n\t\t\t\t}\n\t\t\t\tinputField.value = \"\";\n\t\t\t\tthis.sessionSync();\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\twindow.alert(err);\n\t\t}\n\t\tthis.importSessionsText();\n\t\tthis.forceUpdate();\n\t}\n\timportSessionsText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Allows you to restore your saved windows from an external backup\"\n\t\t});\n\t}\n\tasync toggleHide() {\n\n\t\tif (navigator.userAgent.search(\"Firefox\") > -1) {\n\t\t\tthis.state.hideWindows = false;\n\t\t} else {\n\t\t\tvar granted = await browser.permissions.request({ permissions: [\"system.display\"] });\n\t\t\tif (granted) {\n\t\t\t\tthis.state.hideWindows = !this.state.hideWindows;\n\t\t\t} else {\n\t\t\t\tthis.state.hideWindows = false;\n\t\t\t}\n\t\t}\n\n\t\tawait setLocalStorage(\"hideWindows\", this.state.hideWindows);\n\t\tthis.hideText();\n\t\tthis.forceUpdate();\n\t}\n\thideText() {\n\t\tthis.setState({\n\t\t\tbottomText: \"Automatically minimizes inactive chrome windows. Default : off\"\n\t\t});\n\t}\n\tasync toggleFilterMismatchedTabs() {\n\t\tthis.state.filterTabs = !this.state.filterTabs;\n\t\tawait setLocalStorage(\"filter-tabs\", this.state.filterTabs);\n\t\tthis.forceUpdate();\n\t}\n\tgetTip() {\n\t\tvar tips = [\n\t\t\t\"You can right click on a tab to select it\",\n\t\t\t\"Press enter to move all selected tabs to a new window\",\n\t\t\t\"Middle click to close a tab\",\n\t\t\t\"Tab Manager Plus loves saving time\",\n\t\t\t\"To see incognito tabs, enable incognito access in the extension settings\",\n\t\t\t\"You can drag and drop tabs to other windows\",\n\t\t\t\"You can type to search right away\",\n\t\t\t\"You can search for different tabs : google OR yahoo\"\n\t\t];\n\n\t\treturn \"Tip: \" + tips[Math.floor(Math.random() * tips.length)];\n\t}\n\tisInViewport(element, ofElement) {\n\t\tvar rect = element.getBoundingClientRect();\n\t\treturn rect.top >= 0 && rect.left >= 0 && rect.bottom <= ofElement.height && rect.right <= ofElement.width;\n\t}\n\telVisible(elem) {\n\t\tif (!(elem instanceof Element)) throw Error(\"DomUtil: elem is not an element.\");\n\t\tvar style = getComputedStyle(elem);\n\t\tif (style.display === \"none\") return false;\n\t\tif (style.visibility !== \"visible\") return false;\n\t\tif (style.opacity < 0.1) return false;\n\t\tif (elem.offsetWidth + elem.offsetHeight + elem.getBoundingClientRect().height + elem.getBoundingClientRect().width === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tvar elemCenter = {\n\t\t\tx: elem.getBoundingClientRect().left + elem.offsetWidth / 2,\n\t\t\ty: elem.getBoundingClientRect().top + elem.offsetHeight / 2\n\t\t};\n\n\t\tif (elemCenter.x < 0) return false;\n\t\tif (elemCenter.x > (document.documentElement.clientWidth || window.innerWidth)) return false;\n\t\tif (elemCenter.y < 0) return false;\n\t\tif (elemCenter.y > (document.documentElement.clientHeight || window.innerHeight)) return false;\n\t\tvar pointContainer = document.elementFromPoint(elemCenter.x, elemCenter.y);\n\t\tdo {\n\t\t\tif (pointContainer === elem) return true;\n\t\t} while ((pointContainer = pointContainer.parentNode));\n\t\treturn false;\n\t}\n}\n\nfunction debounce(func, wait, immediate) {\n\tvar timeout;\n\treturn function() {\n\t\tvar context = this,\n\t\t\targs = arguments;\n\t\tvar later = function later() {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\t\tvar callNow = immediate && !timeout;\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\t\tif (callNow) func.apply(context, args);\n\t};\n}\n\nconst maybePluralize = (count, noun, suffix = 's') =>\n  `${count} ${noun}${count !== 1 ? suffix : ''}`;"]}