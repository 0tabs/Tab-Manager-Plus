{"version":3,"sources":["../../../lib/service_worker/ui/open.js"],"names":["getLocalStorage","openInOwnTab","browser","action","setPopup","popup","openPopup","popup_page","runtime","getURL","tabs","query","globalTabsActive","length","currentTab","previousTab","i","tab","url","indexOf","tabId","id","focusOnTabAndWindow","windows","update","windowId","focused","then","highlight","index","bind","create","openAsOwnTab","onClicked","removeListener","addListener","sidebarAction","setPanel","panel","setupPopup","chrome"],"mappings":"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","file":"open.js","sourcesContent":["ï»¿var browser = browser || chrome;\r\n\r\nasync function openPopup() {\r\n\tvar openInOwnTab = await getLocalStorage(\"openInOwnTab\", false);\r\n\tif (openInOwnTab) {\r\n\t\tawait browser.action.setPopup({popup: \"popup.html?popup=true\"});\r\n\t\tawait browser.action.openPopup();\r\n\t\tawait browser.action.setPopup({popup: \"\"});\r\n\t} else {\r\n\t\tawait browser.action.openPopup();\r\n\t}\r\n}\r\n\r\nasync function openAsOwnTab() {\r\n\tvar popup_page = browser.runtime.getURL(\"popup.html\");\r\n\tvar tabs = await browser.tabs.query({});\r\n\r\n\tvar currentTab;\r\n\tvar previousTab;\r\n\tif (!!globalTabsActive && globalTabsActive.length > 1) {\r\n\t\tcurrentTab = globalTabsActive[globalTabsActive.length - 1];\r\n\t\tpreviousTab = globalTabsActive[globalTabsActive.length - 2];\r\n\t}\r\n\r\n\tfor (var i = 0; i < tabs.length; i++) {\r\n\t\tvar tab = tabs[i];\r\n\t\tif (tab.url.indexOf(\"popup.html\") > -1 && tab.url.indexOf(popup_page) > -1) {\r\n\t\t\tif (currentTab && currentTab.tabId && tab.id == currentTab.tabId && previousTab && previousTab.tabId) {\r\n\t\t\t\treturn focusOnTabAndWindow(previousTab);\r\n\t\t\t} else {\r\n\t\t\t\treturn browser.windows.update(tab.windowId, {focused: true}).then(\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\tbrowser.tabs.highlight({windowId: tab.windowId, tabs: tab.index});\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn browser.tabs.create({url: \"popup.html\"});\r\n}\r\n\r\nasync function setupPopup() {\r\n\r\n\tvar openInOwnTab = await getLocalStorage(\"openInOwnTab\", false);\r\n\r\n\tawait browser.action.onClicked.removeListener(openAsOwnTab);\r\n\tif (openInOwnTab) {\r\n\t\tawait browser.action.setPopup({popup: \"\"});\r\n\t\tawait browser.action.onClicked.addListener(openAsOwnTab);\r\n\t} else {\r\n\t\tawait browser.action.setPopup({popup: \"popup.html?popup=true\"});\r\n\t}\r\n\tif (browser.sidebarAction) {\r\n\t\tbrowser.sidebarAction.setPanel({panel: \"popup.html?panel=true\"});\r\n\t}\r\n}"]}