{"version":3,"sources":["../../lib/helpers/migrate.js"],"names":["browser","chrome","stringkeys","jsonkeys","boolkeys","hasLocalStorage","key","localStorage","keyValue","storage","local","get","values","tabs","remove","set","toBoolean","JSON","parse","removeItem","str","toLowerCase"],"mappings":"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","file":"migrate.js","sourcesContent":["ï»¿\"use strict\";\r\n\r\nvar browser = browser || chrome;\r\n\r\nvar stringkeys = [\r\n\t\"layout\"\r\n];\r\n\r\nvar jsonkeys = [\r\n\t\"tabLimit\",\r\n\t\"tabWidth\",\r\n\t\"tabHeight\",\r\n\t\"windowAge\",\r\n\t\"windowNames\",\r\n\t\"windowColors\"\r\n];\r\n\r\nvar boolkeys = [\r\n\t\"openInOwnTab\",\r\n\t\"animations\",\r\n\t\"windowTitles\",\r\n\t\"compact\",\r\n\t\"dark\",\r\n\t\"tabactions\",\r\n\t\"badge\",\r\n\t\"sessionsFeature\",\r\n\t\"hideWindows\",\r\n\t\"filter-tabs\"\r\n];\r\n\r\n(async function () {\r\n\r\n\tvar hasLocalStorage = false;\r\n\r\n\tfor (var key in stringkeys) {\r\n\t\tif (!!localStorage[key]) hasLocalStorage = true;\r\n\t}\r\n\r\n\tfor (var key in boolkeys) {\r\n\t\tif (!!localStorage[key]) hasLocalStorage = true;\r\n\t}\r\n\r\n\tfor (var key in jsonkeys) {\r\n\t\tif (!!localStorage[key]) hasLocalStorage = true;\r\n\t}\r\n\r\n\tif (hasLocalStorage) {\r\n\t\tvar keyValue = {};\r\n\r\n\t\tvar values = await browser.storage.local.get(null);\r\n\t\tvalues = values || {};\r\n\t\t// delete all values that don't have a tabs array\r\n\t\tfor (var key in values) {\r\n\t\t\tif (!!values[key].tabs) {\r\n\t\t\t\tawait browser.storage.local.remove(key);\r\n\t\t\t} else {\r\n\t\t\t\tdelete values[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar keyValue = {};\r\n\t\tkeyValue[\"sessions\"] = values;\r\n\t\tawait browser.storage.local.set(keyValue);\r\n\r\n\t\tvar keyValue = {};\r\n\t\tfor (var key in stringkeys) {\r\n\t\t\tif (!!localStorage[key]) keyValue[key] = localStorage[key];\r\n\t\t}\r\n\r\n\t\tfor (var key in boolkeys) {\r\n\t\t\tif (!!localStorage[key]) keyValue[key] = toBoolean(localStorage[key]);\r\n\t\t}\r\n\r\n\t\tfor (var key in jsonkeys) {\r\n\t\t\tif (!!localStorage[key]) keyValue[key] = JSON.parse(localStorage[key]);\r\n\t\t}\r\n\r\n\t\tawait browser.storage.local.set(keyValue);\r\n\r\n\t\t// clear old localstorage\r\n\t\tfor (var key in stringkeys) localStorage.removeItem(key);\r\n\t\tfor (var key in boolkeys) localStorage.removeItem(key);\r\n\t\tfor (var key in jsonkeys) localStorage.removeItem(key);\r\n\r\n\t}\r\n})();\r\n\r\nfunction toBoolean(str)\r\n{\r\n\tif (typeof str === \"undefined\" || str === null) {\r\n\t\treturn false;\r\n\t} else if (typeof str === \"string\") {\r\n\t\tswitch (str.toLowerCase()) {\r\n\t\t\tcase \"false\":\r\n\t\t\tcase \"no\":\r\n\t\t\tcase \"0\":\r\n\t\t\tcase \"\":\r\n\t\t\t\treturn false;\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t} else if (typeof str === \"number\") {\r\n\t\treturn str !== 0;\r\n\t} else {\r\n\t\treturn true;\r\n\t}\r\n}"]}